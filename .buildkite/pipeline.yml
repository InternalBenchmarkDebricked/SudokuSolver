steps:
  - label: ":shield: Debricked"
    command: mvn dependency:tree -DoutputFile=.debricked-maven-dependencies.tgf -DoutputType=tgf
    plugins:
      - docker#v3.3.0:
          image: maven
          workdir: /app
    env: 
      REPOSITORY: "${BUILDKITE_REPO}"
      COMMIT: "${BUILDKITE_COMMIT}"
      BRANCH: "${BUILDKITE_BRANCH}"
      AUTHOR: "${BUILDKITE_BUILD_AUTHOR}"
    plugins:
      - docker#v3.3.0:
          image: "debricked/debricked-scan"
          environment: 
              - "DEBRICKED_TOKEN"
              - "INTEGRATION_NAME=BuildKite"
              - "REPOSITORY"
              - "COMMIT"
              - "BRANCH"
              - "AUTHOR"
          entrypoint: "/common.sh"

